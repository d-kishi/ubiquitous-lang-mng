# 週次振り返りCommand

**目的**: 週単位での振り返り・改善点抽出・次期計画策定  
**対象**: 週末セッション・振り返り要求時  
**実行タイミング**: ユーザーが「週次振り返り」「振り返り実施」宣言時

## コマンド実行内容

### 1. 振り返り期間・対象確認（必須）
- [ ] 対象期間の明確化（開始日〜終了日・週番号）
- [ ] 対象期間中の作業記録収集（`Doc/04_Daily/YYYY-MM/`から関連ファイル特定）
- [ ] 実施Phase・完了事項の整理（フェーズ進捗・達成状況）

### 2. 成果・マイルストーン整理
- [ ] 期間中の主要成果抽出（完了Phase・重要機能実装・技術基盤確立）
- [ ] 定量的成果測定（品質スコア・時間効率・テスト成功率等）
- [ ] 技術的マイルストーン確認（アーキテクチャ改善・技術負債解消）
- [ ] プロセス改善成果（SubAgent効果・Commands効果・効率化実績）

### 3. 課題・問題分析
- [ ] 発生課題の分類・整理（技術的課題・プロセス課題・要件課題）
- [ ] 未解決問題の継続状況確認（技術負債・継続課題・残存リスク）
- [ ] 新規発見問題の記録（潜在課題・設計問題・運用課題）
- [ ] 問題解決プロセスの効果検証（解決手法・時間効率・品質効果）

### 4. 学習事項・改善提案抽出
- [ ] 重要な技術的学習事項整理（新技術理解・ベストプラクティス発見）
- [ ] プロセス改善知見抽出（SubAgent活用法・Commands効果・効率化手法）
- [ ] 品質向上要因分析（成功要因・品質確保手法・改善効果）
- [ ] 次期改善提案策定（プロセス改善・技術改善・品質改善）

### 5. 効率・品質評価
- [ ] 時間効率測定（予定vs実績・効率化効果・時間配分最適化）
- [ ] 品質指標評価（技術品質・プロセス品質・成果物品質）
- [ ] SubAgent・Commands効果測定（並列実行効果・自動化効果）
- [ ] 組織運用効果検証（Phase適応型組織・専門役割効果）

### 6. 次期計画策定
- [ ] 次週重点事項設定（最優先課題・実施予定Phase・改善事項）
- [ ] 継続課題管理（優先度更新・対応計画・期限設定）
- [ ] リスク管理（潜在リスク・予防策・contingency計画）
- [ ] 改善アクション計画（具体的改善項目・実施方法・効果測定）

### 7. 文書化・記録
- [ ] **週次総括文書作成**: `Doc/04_Daily/YYYY-MM/週次総括_YYYY-WXX.md`
  - 対象期間: YYYY-MM-DD ～ YYYY-MM-DD
  - 週番号: YYYY-WXX形式（例: 2025-W33）
  - 内容: 主要成果・課題分析・学習事項・次期計画
- [ ] **Serenaメモリー更新（直接ファイル編集方式）**: 4種類のメモリー更新
- [ ] 重要決定事項のADR化検討（プロセス改善・技術方針等）

### 8. Serenaメモリー更新（必須・直接ファイル編集方式）

#### 🔴 重要：Context効率化のため直接ファイル編集を使用
**理由**: Context消費87.5%削減・時間75%短縮達成（session-end実績）
**適用範囲**: weekly-retrospectiveコマンド実行時のみ（手動操作・他コマンドでは従来通り`write_memory`使用可能）
**禁止事項**: weekly-retrospective時は`mcp__serena__read_memory` / `mcp__serena__write_memory`使用禁止

#### 更新手順（全メモリー共通）
1. **Grepツール**: 更新対象セクション・行を検索
2. **Readツール**: 必要箇所のみ部分読み込み（limit指定推奨）
3. **Editツール**: 該当箇所のみ差分更新（置換・追記・削除）

#### 各メモリー更新詳細

- [ ] **project_overview更新（`.serena/memories/project_overview.md`）**:
  ```
  必須更新:
  1. Grep "## 📅 週次振り返り実施状況" で該当セクション特定
  2. Read該当セクション周辺（直近の週次振り返り記録部分）
  3. Editツールで以下を更新:
     - 最新週次振り返り記録追加（対象週・実施日・主要成果・重要決定）
     - 次回セッション実施計画更新（次週重点事項反映）
  ```

- [ ] **development_guidelines更新（`.serena/memories/development_guidelines.md`）**:
  ```
  変更がある場合のみ:
  1. Grep該当セクション名（例: "## 🔧 プロセス改善"）で確認
  2. 新規追加の場合:
     - 週次振り返りで確立されたプロセス改善をEditで追記
     - 改善内容・効果・適用範囲を記録
  3. 既存更新の場合:
     - Read該当セクション周辺
     - Editツールで既存プロセス改善セクション更新
  変更がない場合: スキップ
  ```

- [ ] **tech_stack_and_conventions更新（`.serena/memories/tech_stack_and_conventions.md`）**:
  ```
  変更がある場合のみ:
  1. Grep該当セクション名（例: "## ベストプラクティス"）で特定
  2. Read該当セクション周辺
  3. Editツールで週次で確立された技術パターン・ベストプラクティスを追記
  変更がない場合: スキップ
  ```

- [ ] **task_completion_checklist更新（`.serena/memories/task_completion_checklist.md`）**:
  ```
  必須更新:
  1. Grep "## 🔄 次回セッション継続タスク" で該当セクション特定
  2. Editツールで以下を更新:
     - 最終更新日時更新（週次振り返り実施日）
     - 週次完了事項のマーク（- [ ] → - [x]）
     - 次週継続タスクセクション更新（次週重点事項反映）
  ```

- [ ] **メモリー更新品質確認**:
  - 各メモリーの差分更新が適切に実行されたか確認
  - 既存重要情報が維持されているか確認（破壊的変更なし）
  - 次回セッションで参照可能な状態か確認

### 9. 振り返り品質確認
- [ ] 文書完成度確認（必要情報の網羅性・具体性・実用性）
- [ ] 改善提案の実行可能性評価（具体性・優先度・期待効果）
- [ ] 次期アクション明確性確認（実施内容・担当・期限・成功基準）
- [ ] ユーザーへの振り返り結果報告・次期方針確認

### 10. Command実行完了確認・継続判断

#### 🔴 必須実行確認（自己チェック）
**実行証跡必須確認**:
- [ ] **Write/Editツール実行結果確認**: 以下の必須ファイル作成・更新が実際に実行されたか
  - [ ] `週次総括_YYYY-WXX.md` 作成済み（週次総括文書完成）

- [ ] **Readツール実行確認**: 各メモリー更新に必要な箇所の部分読み込み実行
  - [ ] project_overview該当セクション読み込み済み（週次振り返り実施状況部分）
  - [ ] development_guidelines該当セクション読み込み済み（変更がある場合のみ）
  - [ ] tech_stack_and_conventions該当セクション読み込み済み（変更がある場合のみ）
  - [ ] task_completion_checklist該当セクション読み込み済み（次回継続タスク部分）

- [ ] **Editツール実行確認**: 差分更新で4種類のメモリー更新
  - [ ] project_overview差分更新実行済み（週次振り返り記録・次週計画）
  - [ ] development_guidelines差分追記実行済み（変更がある場合のみ・スキップ可）
  - [ ] tech_stack_and_conventions差分追記実行済み（変更がある場合のみ・スキップ可）
  - [ ] task_completion_checklist状態更新実行済み（週次完了マーク・次週継続タスク）

- [ ] **write_memory不使用確認**: weekly-retrospective時は`mcp__serena__write_memory`使用していないことを確認

- [ ] **実行内容品質確認**: 各更新内容が具体的・実用的で次回セッションで参照可能か

#### 🔴 実行漏れ防止チェック
- [ ] **抽象的報告の排除**: 「実施しました」ではなく実際のツール呼び出し実行済み
- [ ] **段階的実行**: 各項目を順次実行し実行結果確認してから次項目へ進行済み
- [ ] **自己検証完了**: 上記全項目の実行証跡確認済み

#### 継続・終了判断
- [ ] **Command実行完了確認**: 上記自己チェック全項目が実行完了していることを確認
- [ ] **次Action提示**: 次週作業開始 or Phase開始 or セッション終了
- [ ] **終了処理**: 週次振り返り全完了確認・次週準備完了宣言

## 文書出力仕様

### ファイル命名規則
- **ファイル名**: `週次総括_YYYY-WXX.md`
- **配置場所**: `Doc/04_Daily/YYYY-MM/`
- **週番号**: ISO 8601準拠（月曜始まり）

### 文書構造標準
```markdown
# 週次総括 YYYY年第XX週（MM/DD-MM/DD）

## 📊 週次概要
### 週の主要テーマ・セッション実績

## 🎯 主要成果・マイルストーン
### Phase別達成状況・技術基盤確立・品質向上

## 📈 技術的成果・改善効果
### 定量的評価・プロセス改善・効率化成果

## 🔍 継続課題・次期対応事項
### 未解決課題・次期重点事項・リスク管理

## 💡 学習事項・改善提案
### 重要発見・ベストプラクティス・改善案

## 🎯 次週重点事項
### 最優先事項・継続改善・品質保証
```

## 実行トリガー
- ユーザー発言: "週次振り返り"、"振り返り実施"
- ユーザー発言: "今週の振り返り"、"週次レビュー"
- 週末セッション時の自動提案（金曜・土曜・日曜セッション時）

## 関連Command連携
- **session-end**: 振り返り要素の集約・継続課題管理
- **step-end-review**: Phase完了時評価の統合
- **spec-compliance-check**: 仕様準拠状況の週次評価
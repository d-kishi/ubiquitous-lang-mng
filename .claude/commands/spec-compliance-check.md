# 仕様準拠確認Command

**目的**: 実装の仕様準拠を確実にチェック  
**対象**: 全実装作業完了時  
**連携**: spec-analysis, spec-compliance SubAgent

## コマンド実行内容

### 1. 仕様準拠マトリックス確認
```bash
# 仕様準拠マトリックス確認
echo "🔍 仕様準拠マトリックス確認を開始..."
```

**確認項目**:
- [ ] /Doc/05_Research/Phase_XX/Spec_Compliance_Matrix.md の全項目チェック
- [ ] 各項目の準拠度が ✅ または改善計画付き ⚠️ であることを確認
- [ ] ❌ 項目がある場合は実装修正が必要

### 2. 肯定的仕様・否定的仕様の実装確認
**肯定的仕様（実装すべき機能）**:
- [ ] 機能仕様書の要求事項が全て実装されているか
- [ ] UI設計書の画面要素が適切に配置されているか
- [ ] ビジネスルールが正しく実装されているか

**否定的仕様（実装してはいけない機能）**:
- [ ] 制約事項に違反する実装がないか
- [ ] セキュリティ要件に反する実装がないか
- [ ] パフォーマンス制約に違反する実装がないか

### 3. コード内仕様書項番コメント確認
```csharp
// 例: 仕様2.1.1準拠コメント確認
// 仕様2.1.1: ユーザー名バリデーション（2-50文字）
RuleFor(x => x.Name)
    .MinimumLength(2).WithMessage("ユーザー名は2文字以上で入力してください。");
```

**確認項目**:
- [ ] 重要な実装箇所に仕様書項番コメントが記載されている
- [ ] コメント内容と実装内容が一致している
- [ ] 仕様変更時にコメントも更新されている

### 4. データベース設計準拠確認
- [ ] テーブル構造が設計書通りに実装されている
- [ ] 制約（主キー・外部キー・一意制約）が適切に設定されている
- [ ] PostgreSQL固有機能（TIMESTAMPTZ、JSONB等）が活用されている

### 5. エラーハンドリング・ユーザビリティ確認
- [ ] 適切なエラーメッセージが表示される
- [ ] バリデーションエラーがユーザーフレンドリーな形で表示される
- [ ] 例外処理が適切に実装されている

## 実行後アクション（スコアリングベース）

### 総合品質判定
✅ **95点以上**: 優秀品質 → 仕様準拠確認完了・即座リリース可能  
⚠️ **85-94点**: 良好品質 → 指摘事項改善後リリース可能  
⚠️ **75-84点**: 改善必要 → 項目的改善必要・再チェック  
❌ **75点未満**: 品質不適格 → 大幅な実装修正必要・全面見直し

### 個別スコア対応
- **仕様準拠スコア 90点未満**: spec-compliance再実行必要
- **設計品質スコア 85点未満**: design-review再実行必要
- **重複実装検出**: 統一作業必要（優先度高）
- **原典照合エラー**: 仕様書再読み込み必要

## SubAgent連携（強化版）
### 主要SubAgent
- **spec-analysis**: 原典仕様書分析 → 仕様マトリックス作成
- **spec-compliance**: 原典照合 + 実装監査 → スコアリング + 証跡記録
- **design-review**: 原典設計書照合 → 設計品質スコアリング

### 補完SubAgent
- **code-review**: 仕様準拠観点コードレビュー（必要時）
- **unit-test**: 仕様準拠テストケース作成（必要時）

### 連携フロー
1. **spec-analysis** → 仕様マトリックス作成
2. **spec-compliance** → マトリックス + 原典照合 → スコアリング
3. **design-review** → 設計品質スコアリング
4. **総合判定** → 品質基準適合性確認
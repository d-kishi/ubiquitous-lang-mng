# Step終了時レビューCommand

**目的**: Step完了時に必須のレビュープロセスを自動実行
**対象**: 全Phase・全Step

## コマンド実行内容

### 1. 仕様準拠確認（必須）
- [ ] 仕様準拠マトリックスの全項目が✅状態かチェック
- [ ] 否定的仕様（実装してはいけない機能）の非実装確認
- [ ] コード内の仕様書項番コメント記載確認
- [ ] 仕様逸脱リスクの最終確認

### 2. TDD実践確認（必須）
- [ ] Red-Green-Refactorサイクルの実践記録確認
- [ ] 各機能でテストが先行作成されたことの確認
- [ ] Redフェーズでテスト失敗が確認されたことの検証
- [ ] テストファースト開発の改善点・課題記録

### 3. テスト品質確認・保証
- [ ] 新規実装機能の単体テスト完成・成功確認
- [ ] 統合テスト実行・課題解決完了確認
- [ ] テストカバレッジ80%以上維持確認
- [ ] 全テスト成功状態でのStep完了確認

### 3.5. テストプロジェクト作成整合性確認（🆕 Issue #40再発防止）
**条件**: 当該Stepで新規テストプロジェクト作成が行われた場合

- [ ] **ガイドライン全チェックリスト実施確認**
  - `/Doc/08_Organization/Rules/新規テストプロジェクト作成ガイドライン.md`の全項目実施確認
- [ ] **テストアーキテクチャ設計書との整合性確認**
  - プロジェクト構成図への反映確認
  - 命名規則準拠確認
  - 参照関係原則準拠確認
- [ ] **ADR_020準拠確認**
  - レイヤー×テストタイプ分離方式準拠確認
  - EnableDefaultCompileItems等の技術負債非作り込み確認

### 4. 技術負債記録・管理
- [ ] 新規技術負債のGitHub Issue作成完了（TECH-XXX番号付与）
- [ ] 既存技術負債Issueの更新・進捗記録完了
- [ ] スタブメソッド実装時のIssue作成・優先度ラベル設定完了
- [ ] 技術負債分類（enhancement/bug）・工数見積もり記録完了

### 5. ユーザー報告・承認取得
- [ ] Step完了・レビュー結果をユーザーに報告
- [ ] Step完了承認取得
- [ ] 次Step実行可否の確認・承認取得

### 5.5. Phaseゴール達成率確認（Phase A教訓適用・必須）

**重要原則**: Step単体評価ではなく、Phase全体ゴールへの寄与を評価

#### 累積達成率の確認
- [ ] **現在の達成率算出**:
  - 現在のStep完了によるPhase全体ゴール達成率（%）を算出
  - ブレイクダウン計画のゴール寄与率に基づく累積計算
  - Phase_Summary.mdの「ブレイクダウン計画とゴール寄与率」表を参照

- [ ] **完成度マトリックス更新**:
  - **UI実装**: 現在の画面実装率（X/Y画面・Z%）
  - **エンドユーザー操作**: 現在の操作可能率（X/Y操作・Z%）
  - **Domain層**: 完成度（%）
  - **Application層**: 完成度（%）
  - **Infrastructure層**: 完成度（%）
  - **E2Eテスト**: シナリオ実装率（X/Yシナリオ・Z%）
  - Phase_Summary.mdの「完成度マトリックス」表を更新

#### 残存Step検証
- [ ] **100%達成可能性検証**:
  - 残りのStepで100%達成可能かを検証
  - 不足している場合、追加Step必要性をユーザーに報告
  - スコープ調整または計画見直しの提案

- [ ] **Phase成功基準との整合性確認**:
  - Phase_Summary.mdの「Phase成功基準」と現在の進捗を照合
  - UI設計書X.X-X.X節 100%実装の進捗確認
  - エンドユーザー操作 100%可能の進捗確認
  - 完成度マトリックス全項目 100%達成の進捗確認

#### 単体評価の禁止
- [ ] **全体ゴール視点での評価**:
  - 「このStepはOK」ではなく「全体ゴールへの寄与」を評価
  - Phase完了基準との整合性を必ず確認
  - 部分最適化の防止・Phase全体最適化の重視

**Phase A教訓の適用**:
- ❌ Step単体で「OK」判定 → 積み上げ不足 → Phase完了時に対応漏れ（37.5%完成）
- ✅ 常にPhaseゴール視点 → 累積達成率追跡 → Phase完了時に100%達成

## 実行後アクション
✅ 全チェック完了 → Step完了・次step-start実行準備  
⚠️ 未完了項目あり → 該当項目完了後・次Step進行準備  
❌ 重要な問題発見 → 問題解決後に再レビュー実施

## 関連プロセス
- **SubAgent活用**: spec-compliance, unit-test, integration-test, code-review
- **成果物確認**: /Doc/08_Organization/Active/Phase_XX/Research/ 配下ファイル確認
- **記録更新**: /Doc/08_Organization/Active/Phase_XX/ 配下ファイル更新
- **次プロセス連携**: Step完了後 → step-start Command実行 → 次Step組織設計・準備
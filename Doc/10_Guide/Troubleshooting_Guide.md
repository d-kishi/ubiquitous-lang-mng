# ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ - Phase A2

**ä½œæˆæ—¥**: 2025-07-20  
**å¯¾è±¡**: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ãƒ»é–‹ç™ºè€…  
**Phase**: A2ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½  

## ðŸš¨ ç·Šæ€¥åº¦åˆ¥å¯¾å¿œãƒ•ãƒ­ãƒ¼

### ðŸ”´ ç·Šæ€¥ï¼ˆã‚·ã‚¹ãƒ†ãƒ åœæ­¢ï¼‰
**å¯¾å¿œæ™‚é–“**: å³åº§ï¼ˆ5åˆ†ä»¥å†…ï¼‰
1. **ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª**
2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹ç¢ºèª** 
3. **ç·Šæ€¥å¾©æ—§æ‰‹é †å®Ÿè¡Œ**
4. **å½±éŸ¿ç¯„å›²æŠŠæ¡ãƒ»å ±å‘Š**

### ðŸŸ¡ é‡è¦ï¼ˆæ©Ÿèƒ½åˆ¶é™ï¼‰
**å¯¾å¿œæ™‚é–“**: 30åˆ†ä»¥å†…
1. **å•é¡Œç‰¹å®šãƒ»åˆ†é›¢**
2. **å›žé¿ç­–æä¾›**
3. **æ ¹æœ¬è§£æ±ºè¨ˆç”»**

### ðŸŸ¢ é€šå¸¸ï¼ˆè»½å¾®ãªå•é¡Œï¼‰
**å¯¾å¿œæ™‚é–“**: 2æ™‚é–“ä»¥å†…
1. **èª¿æŸ»ãƒ»è§£æ±º**
2. **å†ç™ºé˜²æ­¢ç­–æ¤œè¨Ž**

## ðŸ“‹ ç—‡çŠ¶åˆ¥è¨ºæ–­ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

### ãƒ­ã‚°ã‚¤ãƒ³å•é¡Œ

#### ã€Œãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã€
```
1. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª
   â”œâ”€ æ­£ã—ã„ â†’ 2ã¸
   â””â”€ é–“é•ã„ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ­£ã—ã„æƒ…å ±ç¢ºèªä¾é ¼

2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ…‹ç¢ºèª
   â”œâ”€ ã‚¢ã‚¯ãƒ†ã‚£ãƒ– â†’ 3ã¸
   â””â”€ ç„¡åŠ¹ â†’ ç®¡ç†è€…ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœ‰åŠ¹åŒ–ä¾é ¼

3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŽ¥ç¶šç¢ºèª
   â”œâ”€ æ­£å¸¸ â†’ 4ã¸
   â””â”€ ç•°å¸¸ â†’ ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å•é¡Œã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‚ç…§

4. ASP.NET Core Identityç¢ºèª
   â”œâ”€ æ­£å¸¸ â†’ ã‚µãƒãƒ¼ãƒˆé€£çµ¡
   â””â”€ ç•°å¸¸ â†’ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•
```

#### ã€Œãƒ­ã‚°ã‚¤ãƒ³å¾Œã«æ¨©é™ã‚¨ãƒ©ãƒ¼ã€
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç¢ºèª
   â”œâ”€ é©åˆ‡ â†’ 2ã¸
   â””â”€ ä¸é©åˆ‡ â†’ ç®¡ç†è€…ã«ãƒ­ãƒ¼ãƒ«å¤‰æ›´ä¾é ¼

2. æ“ä½œå¯¾è±¡ã¨ã®æ¨©é™é–¢ä¿‚ç¢ºèª
   â”œâ”€ å•é¡Œãªã— â†’ 3ã¸
   â””â”€ æ¨©é™ä¸è¶³ â†’ æ¨©é™èª¬æ˜Žãƒ»ä»£æ›¿æ‰‹æ®µææ¡ˆ

3. ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
   â”œâ”€ æœ‰åŠ¹ â†’ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œã¨ã—ã¦èª¿æŸ»
   â””â”€ ç„¡åŠ¹ â†’ å†ãƒ­ã‚°ã‚¤ãƒ³ä¾é ¼
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å•é¡Œ

#### ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã‚¨ãƒ©ãƒ¼ã€
```
System.InvalidOperationException: Cannot use table 'AspNetUsers'
```

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. PostgreSQLã‚³ãƒ³ãƒ†ãƒŠçŠ¶æ…‹ç¢ºèª
docker ps | grep postgres
# æœŸå¾…å€¤: UPçŠ¶æ…‹

# 2. ã‚³ãƒ³ãƒ†ãƒŠãƒ­ã‚°ç¢ºèª
docker logs ubiquitous-lang-mng_postgresql_1
# ç¢ºèªé …ç›®: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€æŽ¥ç¶šæ‹’å¦

# 3. æŽ¥ç¶šãƒ†ã‚¹ãƒˆ
docker exec -it [postgres_container] psql -U ubiquitous_user -d ubiquitous_db
```

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: ã‚³ãƒ³ãƒ†ãƒŠå†èµ·å‹•
docker-compose restart postgresql
sleep 10

# æ‰‹é †2: ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèªãƒ»å®Ÿè¡Œ
dotnet ef database update --project src/UbiquitousLanguageManager.Infrastructure

# æ‰‹é †3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•
dotnet run --project src/UbiquitousLanguageManager.Web
```

#### ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŽ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€
**ç—‡çŠ¶**: ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ãŒéžå¸¸ã«é…ã„ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. æŽ¥ç¶šæ•°ç¢ºèª
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "SELECT count(*) FROM pg_stat_activity;"

# 2. é•·æ™‚é–“å®Ÿè¡Œã‚¯ã‚¨ãƒªç¢ºèª
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "SELECT pid, now() - pg_stat_activity.query_start AS duration, query FROM pg_stat_activity WHERE (now() - pg_stat_activity.query_start) > interval '5 minutes';"
```

**è§£æ±ºæ‰‹é †**:
```bash
# 1. é•·æ™‚é–“ã‚¯ã‚¨ãƒªçµ‚äº†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "SELECT pg_terminate_backend([pid]);"

# 2. æŽ¥ç¶šãƒ—ãƒ¼ãƒ«å†åˆæœŸåŒ–
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•

# 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ï¼ˆå®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ™‚ï¼‰
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "REINDEX DATABASE ubiquitous_db;"
```

### DevContainerãƒ»é–‹ç™ºç’°å¢ƒå•é¡Œ

**å¯¾è±¡**: Phase B-F2ä»¥é™ï¼ˆDevContainerç’°å¢ƒï¼‰
**é–¢é€£**: ADR_026ï¼ˆDevContainer HTTPSè¨¼æ˜Žæ›¸ç®¡ç†æ–¹é‡ï¼‰ã€`Doc/99_Others/DevContainerä½¿ç”¨ã‚¬ã‚¤ãƒ‰.md`

#### ã€ŒHTTPSè¨¼æ˜Žæ›¸ã‚¨ãƒ©ãƒ¼ã€
**ç—‡çŠ¶**: ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«HTTPSè¨¼æ˜Žæ›¸ã‚¨ãƒ©ãƒ¼
```
System.InvalidOperationException: 'Unable to configure HTTPS endpoint. No server certificate was specified, and the default developer certificate could not be found or is out of date.'
```

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. setup-https.shãƒ­ã‚°ç¢ºèªï¼ˆDevContainerèµ·å‹•ãƒ­ã‚°ï¼‰
# âš ï¸  ERROR: HTTPS certificate not found! ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŽ¢ã™

# 2. ãƒ›ã‚¹ãƒˆç’°å¢ƒã§è¨¼æ˜Žæ›¸å­˜åœ¨ç¢ºèª
ls -lh $USERPROFILE/.aspnet/https/aspnetapp.pfx  # Windows
ls -lh ~/.aspnet/https/aspnetapp.pfx              # macOS/Linux
```

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: ãƒ›ã‚¹ãƒˆç’°å¢ƒã§è¨¼æ˜Žæ›¸ç”Ÿæˆ
# Windowsï¼ˆPowerShellã¾ãŸã¯Git Bashï¼‰
mkdir -p $USERPROFILE/.aspnet/https
dotnet dev-certs https --clean
dotnet dev-certs https -ep $USERPROFILE/.aspnet/https/aspnetapp.pfx -p DevPassword123
dotnet dev-certs https --trust

# macOS/Linux
mkdir -p ~/.aspnet/https
dotnet dev-certs https --clean
dotnet dev-certs https -ep ~/.aspnet/https/aspnetapp.pfx -p DevPassword123
dotnet dev-certs https --trust  # Linuxã§ã¯éžå¯¾å¿œ

# æ‰‹é †2: DevContainerå†æ§‹ç¯‰
# VS Code: Ctrl+Shift+P â†’ "Dev Containers: Rebuild Container"

# æ‰‹é †3: setup-https.shæˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¢ºèª
# âœ… HTTPS certificate found: /home/vscode/.aspnet/https/aspnetapp.pfx
```

**ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºæº–**: è¨¼æ˜Žæ›¸ç”Ÿæˆã‚³ãƒžãƒ³ãƒ‰ãŒã‚¨ãƒ©ãƒ¼ã®å ´åˆ

---

#### ã€Œsetup-https.shã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¨ãƒ©ãƒ¼ã€
**ç—‡çŠ¶**: DevContainerèµ·å‹•æ™‚ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼
```
: invalid optionripts/setup-https.sh: line 2: set: -
.devcontainer/scripts/setup-https.sh: line 3: \r': command not found
```

**åŽŸå› **: ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒCRLFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆWindowsï¼‰ã«ãªã£ã¦ã„ã‚‹

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: Gitå†æ­£è¦åŒ–ï¼ˆãƒ›ã‚¹ãƒˆç’°å¢ƒï¼‰
git add --renormalize .
git status
# setup-https.shãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
git commit -m "Fix: Normalize line endings for setup-https.sh"

# æ‰‹é †2: DevContainerå†æ§‹ç¯‰
# VS Code: Ctrl+Shift+P â†’ "Dev Containers: Rebuild Container"
```

**ä»£æ›¿æ‰‹é †**ï¼ˆGitå†æ­£è¦åŒ–ã§è§£æ±ºã—ãªã„å ´åˆï¼‰:
```bash
# DevContainerå†…ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†ä½œæˆ
cat > .devcontainer/scripts/setup-https.sh <<'EOF'
#!/bin/bash
set -e
ï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ï¼‰
EOF

chmod +x .devcontainer/scripts/setup-https.sh
```

**ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºæº–**: Gitå†æ­£è¦åŒ–ã§ã‚‚è§£æ±ºã—ãªã„å ´åˆ

---

#### ã€Œãƒ–ãƒ©ã‚¦ã‚¶è¨¼æ˜Žæ›¸è­¦å‘Šã€
**ç—‡çŠ¶**: https://localhost:5001 ã«ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã€ã€Œã“ã®æŽ¥ç¶šã§ã¯ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãŒä¿è­·ã•ã‚Œã¾ã›ã‚“ã€è­¦å‘Šè¡¨ç¤º

**åŽŸå› **: ãƒ›ã‚¹ãƒˆç’°å¢ƒã§è¨¼æ˜Žæ›¸ã®ä¿¡é ¼è¨­å®šæœªå®Ÿæ–½

**è§£æ±ºæ‰‹é †**:
```bash
# ãƒ›ã‚¹ãƒˆç’°å¢ƒã§å®Ÿè¡Œ
dotnet dev-certs https --trust

# ãƒ–ãƒ©ã‚¦ã‚¶å†èµ·å‹•
# https://localhost:5001 ã«å†ã‚¢ã‚¯ã‚»ã‚¹
```

**æ‰‹å‹•æ‰¿èª**ï¼ˆLinuxç’°å¢ƒã®ã¿ï¼‰:
- ãƒ–ãƒ©ã‚¦ã‚¶ã§ã€Œè©³ç´°è¨­å®šã€â†’ã€Œlocalhost ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ï¼ˆå®‰å…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
- é–‹ç™ºç’°å¢ƒå°‚ç”¨è¨¼æ˜Žæ›¸ã®ãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãªã—

---

#### ã€ŒDevContainerèµ·å‹•å¤±æ•—ã€
**ç—‡çŠ¶**: DevContainerèµ·å‹•æ™‚ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºãƒ»èµ·å‹•ä¸­æ–­

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. Docker DesktopçŠ¶æ…‹ç¢ºèªï¼ˆãƒ›ã‚¹ãƒˆç’°å¢ƒï¼‰
docker ps
# æœŸå¾…å€¤: DOCKERã‚³ãƒ³ãƒ†ãƒŠä¸€è¦§è¡¨ç¤º

# 2. Docker Desktopèµ·å‹•ç¢ºèª
# Docker Desktopå³ä¸‹ãŒç·‘è‰²ï¼ˆRunningï¼‰ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

# 3. Dockerãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç¢ºèª
# Docker Desktop â†’ Settings â†’ Resources â†’ Disk image location
```

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: Docker Desktopå†èµ·å‹•
# Docker Desktop â†’ Quit Docker Desktop â†’ å†èµ·å‹•

# æ‰‹é †2: ä¸è¦ãªDockerã‚¤ãƒ¡ãƒ¼ã‚¸å‰Šé™¤ï¼ˆãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³ã®å ´åˆï¼‰
docker system prune -a
# è­¦å‘Š: å…¨ã¦ã®åœæ­¢ä¸­ã‚³ãƒ³ãƒ†ãƒŠãƒ»æœªä½¿ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå‰Šé™¤ã•ã‚Œã¾ã™

# æ‰‹é †3: DevContainerå†æ§‹ç¯‰
# VS Code: Ctrl+Shift+P â†’ "Dev Containers: Rebuild Container"
```

**ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºæº–**: Docker Desktopè¨­å®šæ­£å¸¸ã§ã‚‚èµ·å‹•å¤±æ•—ã®å ´åˆ

---

#### ã€ŒPostgreSQLæŽ¥ç¶šã‚¨ãƒ©ãƒ¼ï¼ˆDevContainerç’°å¢ƒï¼‰ã€
**ç—‡çŠ¶**: DevContainerå†…ã‹ã‚‰PostgreSQLã«æŽ¥ç¶šã§ããªã„
```
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
```

**åŽŸå› **: æŽ¥ç¶šæ–‡å­—åˆ—ãŒ`Host=localhost`ã«ãªã£ã¦ã„ã‚‹ï¼ˆDevContainerç’°å¢ƒã§ã¯ä¸é©åˆ‡ï¼‰

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: appsettings.Development.jsonç¢ºèª
cat src/UbiquitousLanguageManager.Web/appsettings.Development.json
# "ConnectionStrings" â†’ "DefaultConnection" â†’ "Host=" ã®å€¤ã‚’ç¢ºèª

# æ‰‹é †2: æŽ¥ç¶šæ–‡å­—åˆ—ä¿®æ­£
# Host=localhost â†’ Host=postgres ã«å¤‰æ›´
# ï¼ˆpostgresã¯Docker Composeã‚µãƒ¼ãƒ“ã‚¹åï¼‰

# ä¿®æ­£ä¾‹:
"ConnectionStrings": {
  "DefaultConnection": "Host=postgres;Port=5432;Database=ubiquitous_lang_db;Username=ubiquitous_lang_user;Password=ubiquitous_lang_password"
}

# æ‰‹é †3: ã‚¢ãƒ—ãƒªå†èµ·å‹•
dotnet run --project src/UbiquitousLanguageManager.Web
```

**ç†ç”±**: DevContainerã‹ã‚‰PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã¸ã®æŽ¥ç¶šã¯ã€Docker Composeã‚µãƒ¼ãƒ“ã‚¹åï¼ˆ`postgres`ï¼‰ã‚’ä½¿ç”¨

---

#### ã€Œè¨¼æ˜Žæ›¸æœ‰åŠ¹æœŸé™åˆ‡ã‚Œã€
**ç—‡çŠ¶**: ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«è¨¼æ˜Žæ›¸æœŸé™åˆ‡ã‚Œã‚¨ãƒ©ãƒ¼ï¼ˆè¨¼æ˜Žæ›¸ç”Ÿæˆã‹ã‚‰1å¹´å¾Œï¼‰
```
System.InvalidOperationException: 'Unable to configure HTTPS endpoint. The certificate is expired.'
```

**è§£æ±ºæ‰‹é †**:
```bash
# æ‰‹é †1: ãƒ›ã‚¹ãƒˆç’°å¢ƒã§è¨¼æ˜Žæ›¸å†ç”Ÿæˆï¼ˆ2-3åˆ†ï¼‰
dotnet dev-certs https --clean
dotnet dev-certs https -ep $USERPROFILE/.aspnet/https/aspnetapp.pfx -p DevPassword123  # Windows
dotnet dev-certs https -ep ~/.aspnet/https/aspnetapp.pfx -p DevPassword123              # macOS/Linux
dotnet dev-certs https --trust

# æ‰‹é †2: DevContainerå†…ã§ã‚¢ãƒ—ãƒªå†èµ·å‹•
# å†æ§‹ç¯‰ã¯ä¸è¦ï¼ˆè¨¼æ˜Žæ›¸ãŒãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒžã‚¦ãƒ³ãƒˆã§å…±æœ‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚ï¼‰
dotnet run --project src/UbiquitousLanguageManager.Web
```

**äºˆé˜²**: è¨¼æ˜Žæ›¸ç”Ÿæˆã‹ã‚‰11ãƒ¶æœˆå¾Œã«æ›´æ–°ï¼ˆä½™è£•ã‚’æŒã£ã¦ï¼‰

**è©³ç´°**: `Doc/99_Others/DevContainerä½¿ç”¨ã‚¬ã‚¤ãƒ‰.md` â†’ [6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](DevContainerä½¿ç”¨ã‚¬ã‚¤ãƒ‰.md#6-ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹å•é¡Œ

#### ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§è¡¨ç¤ºãŒé…ã„ã€
**ç—‡çŠ¶**: 1000äººä»¥ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ä¸€è¦§è¡¨ç¤ºã«10ç§’ä»¥ä¸Š

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ç¢ºèª
# ç®¡ç†ç”»é¢ã§ç¢ºèªã€ã¾ãŸã¯ç›´æŽ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "SELECT COUNT(*) FROM \"AspNetUsers\";"

# 2. å®Ÿè¡Œãƒ—ãƒ©ãƒ³ç¢ºèªï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
# ã‚¯ã‚¨ãƒªã®å®Ÿè¡Œãƒ—ãƒ©ãƒ³åˆ†æž
```

**è§£æ±ºæ‰‹é †**:
1. **ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã‚µã‚¤ã‚ºèª¿æ•´**
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20ä»¶ â†’ 10ä»¶ã«å¤‰æ›´
   - ç®¡ç†ç”»é¢è¨­å®šã§èª¿æ•´

2. **ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°åˆ©ç”¨æŽ¨å¥¨**
   - ãƒ­ãƒ¼ãƒ«çµžã‚Šè¾¼ã¿
   - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹çµžã‚Šè¾¼ã¿
   - åå‰ãƒ»ãƒ¡ãƒ¼ãƒ«éƒ¨åˆ†æ¤œç´¢

3. **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç¢ºèª**ï¼ˆé–‹ç™ºè€…å¯¾å¿œï¼‰
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼å
   - ä½œæˆæ—¥æ™‚

#### ã€Œæ¤œç´¢æ©Ÿèƒ½ãŒé…ã„ã€
**ç—‡çŠ¶**: ç‰¹å®šæ¡ä»¶ã§ã®æ¤œç´¢ã«æ™‚é–“ãŒã‹ã‹ã‚‹

**è§£æ±ºæ‰‹é †**:
1. **æ¤œç´¢æ¡ä»¶æœ€é©åŒ–**
   - æ›–æ˜§æ¤œç´¢ã®åˆ¶é™
   - å¿…é ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¿½åŠ 

2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–**ï¼ˆé€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ï¼‰
```bash
# çµ±è¨ˆæƒ…å ±æ›´æ–°
docker exec [postgres_container] psql -U ubiquitous_user -d ubiquitous_db -c "ANALYZE;"
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†å•é¡Œ

#### ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆãŒã§ããªã„ã€
**ç—‡çŠ¶**: æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆæ™‚ã«ã‚¨ãƒ©ãƒ¼

**è¨ºæ–­ãƒ•ãƒ­ãƒ¼**:
```
1. ä½œæˆè€…æ¨©é™ç¢ºèª
   â”œâ”€ SuperUser/ProjectManager â†’ 2ã¸
   â””â”€ ãã®ä»– â†’ æ¨©é™ä¸è¶³ã‚¨ãƒ©ãƒ¼

2. ä½œæˆå¯¾è±¡ãƒ­ãƒ¼ãƒ«ç¢ºèª
   â”œâ”€ æ¨©é™å†… â†’ 3ã¸
   â””â”€ æ¨©é™å¤– â†’ æ¨©é™åˆ¶é™ã‚¨ãƒ©ãƒ¼

3. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹é‡è¤‡ç¢ºèª
   â”œâ”€ é‡è¤‡ãªã— â†’ 4ã¸
   â””â”€ é‡è¤‡ã‚ã‚Š â†’ é‡è¤‡ã‚¨ãƒ©ãƒ¼

4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ç¢ºèª
   â”œâ”€ å½¢å¼æ­£å¸¸ â†’ ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼èª¿æŸ»
   â””â”€ å½¢å¼ç•°å¸¸ â†’ å…¥åŠ›å†…å®¹ä¿®æ­£ä¾é ¼
```

#### ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ãŒã§ããªã„ã€
**ç—‡çŠ¶**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã«å¤±æ•—

**ç¢ºèªé …ç›®**:
1. **ç¾åœ¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã®æ­£ç¢ºæ€§
2. **æ–°ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦**
   - 8æ–‡å­—ä»¥ä¸Š
   - å¤§æ–‡å­—ãƒ»å°æ–‡å­—ãƒ»æ•°å­—å«ã‚€
3. **ç¢ºèªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã®ä¸€è‡´

**è§£æ±ºæ‰‹é †**:
1. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¦ä»¶èª¬æ˜Ž**
2. **å¼·åˆ¶ãƒªã‚»ãƒƒãƒˆ**ï¼ˆç®¡ç†è€…æ¨©é™å¿…è¦ï¼‰
3. **ä¸€æ™‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç™ºè¡Œ**

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œ

#### ã€Œä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥ã€
**ç—‡çŠ¶**: ä¸å¯©ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã€æ¨©é™å¤–æ“ä½œ

**å³åº§ã®å¯¾å¿œ**:
1. **è©²å½“ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸€æ™‚åœæ­¢**
```bash
# ç®¡ç†ç”»é¢ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–
# ã¾ãŸã¯ç›´æŽ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ï¼ˆç·Šæ€¥æ™‚ï¼‰
```

2. **ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç¢ºèª**
3. **å½±éŸ¿ç¯„å›²èª¿æŸ»**
4. **å¿…è¦ã«å¿œã˜ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åˆ¶ãƒªã‚»ãƒƒãƒˆ**

### çµ±åˆãƒ†ã‚¹ãƒˆå•é¡Œï¼ˆPhase A3ã§è§£æ±ºäºˆå®šï¼‰

#### ã€Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼ã€
**ç—‡çŠ¶**: `dotnet test` ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãƒ»å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼

**æ—¢çŸ¥ã®å•é¡Œ**:
1. **F# Optionåž‹å•é¡Œ**
   - C#ãƒ†ã‚¹ãƒˆã§F#ã®Optionåž‹ã‚¢ã‚¯ã‚»ã‚¹
   - `IsSome`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¨ãƒ©ãƒ¼

2. **Command DTOå•é¡Œ**
   - F#ãƒ¬ã‚³ãƒ¼ãƒ‰åž‹ã®èª­ã¿å–ã‚Šå°‚ç”¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
   - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–å­ä½¿ç”¨ä¸å¯

3. **ApplicationUserå•é¡Œ**
   - UserEntityã¨ãƒ†ãƒ¼ãƒ–ãƒ«ç«¶åˆ
   - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸ä¸€è‡´

**å›žé¿ç­–**:
- å®Ÿã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‹•ä½œç¢ºèªã«é›†ä¸­
- Phase A3ã§ã®åŒ…æ‹¬çš„è§£æ±ºå¾…ã¡

## ðŸ”§ å¾©æ—§æ‰‹é †ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

### æ¨™æº–å¾©æ—§æ‰‹é †
```bash
# 1. ç¾çŠ¶æŠŠæ¡
systemctl status ubiquitous-lang-mng  # ã¾ãŸã¯ ps aux | grep dotnet
docker ps | grep postgres

# 2. ãƒ­ã‚°ç¢ºèª
tail -n 100 /var/log/ubiquitous-lang-mng/app.log
docker logs ubiquitous-lang-mng_postgresql_1

# 3. åŸºæœ¬å¾©æ—§
docker-compose restart postgresql
sleep 10
systemctl restart ubiquitous-lang-mng

# 4. å‹•ä½œç¢ºèª
curl -I http://localhost:5000/health
# ã¾ãŸã¯ç®¡ç†ç”»é¢ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¾©æ—§æ‰‹é †
```bash
# 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª
ls -la /backups/ubiquitous_db_*

# 2. ç·Šæ€¥å¾©æ—§ï¼ˆæœ€æ–°ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ï¼‰
docker exec [postgres_container] pg_restore -U ubiquitous_user -d ubiquitous_db /backups/latest.backup

# 3. ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
dotnet ef database update --project src/UbiquitousLanguageManager.Infrastructure

# 4. ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç¢ºèª
# ç®¡ç†ç”»é¢ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ç¢ºèª
```

## ðŸ“ž ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºæº–

### ãƒ¬ãƒ™ãƒ«1ï¼ˆç®¡ç†è€…å¯¾å¿œï¼‰
- è¨­å®šå¤‰æ›´
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå•é¡Œ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹èª¿æ•´

### ãƒ¬ãƒ™ãƒ«2ï¼ˆé–‹ç™ºè€…å¯¾å¿œï¼‰
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒžå•é¡Œ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œ

### ãƒ¬ãƒ™ãƒ«3ï¼ˆå¤–éƒ¨æ”¯æ´ï¼‰
- ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å•é¡Œ
- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ç ´æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ

## ðŸ“Š å•é¡Œåˆ†æžãƒ»è¨˜éŒ²

### å•é¡Œè¨˜éŒ²ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```markdown
## å•é¡Œæ¦‚è¦
- ç™ºç”Ÿæ—¥æ™‚: YYYY-MM-DD HH:MM
- å½±éŸ¿ç¯„å›²: [å…¨ä½“/ç‰¹å®šæ©Ÿèƒ½/ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼]
- ç·Šæ€¥åº¦: [é«˜/ä¸­/ä½Ž]

## ç—‡çŠ¶
- [å…·ä½“çš„ãªç—‡çŠ¶]
- [ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]

## åŽŸå› 
- [åˆ¤æ˜Žã—ãŸåŽŸå› ]

## å¯¾å¿œå†…å®¹
- [å®Ÿæ–½ã—ãŸå¯¾å¿œ]
- [å¾©æ—§æ™‚åˆ»]

## å†ç™ºé˜²æ­¢ç­–
- [æ”¹å–„é …ç›®]
```

---

**ç·Šæ€¥é€£çµ¡å…ˆ**: é–‹ç™ºãƒãƒ¼ãƒ   
**ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€… â†’ é–‹ç™ºãƒãƒ¼ãƒ  â†’ å¤–éƒ¨æ”¯æ´  
**æœ€çµ‚æ›´æ–°**: 2025-07-20  
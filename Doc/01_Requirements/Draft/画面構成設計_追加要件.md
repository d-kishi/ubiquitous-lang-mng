# 画面構成設計 追加要件

**作成日**: 2025-06-27  
**目的**: 画面構成設計を進めるために必要な詳細要件の確認  
**対象**: ユビキタス言語管理システム  

## 1. ユーザーロール別の画面表示制御詳細

### 1.1 各ロールが見える画面・機能の詳細

#### スーパーユーザー
- **表示可能画面**:
  ```
  ログイン
  プロフィール変更
  パスワード変更
  パスワードリセットメール送信
  パスワードリセット実行
  ユーザ一覧
  ユーザ登録
  ユーザ編集
  プロジェクト一覧
  プロジェクト登録
  プロジェクト編集
  ドメイン一覧
  ドメイン登録
  ドメイン編集
  ユビキタス言語一覧
  ユビキタス言語入力・編集
  ユビキタス言語承認
  ```

- **専用機能・操作**:
  ```
  新規プロジェクト作成
  全ユーザの権限設定変更
  スーパーユーザとプロジェクト管理者の新規登録
  ```

#### プロジェクト管理者
- **表示可能画面**:
  ```
  ログイン
  プロフィール変更
  パスワード変更
  パスワードリセットメール送信
  パスワードリセット実行
  ユーザ一覧
  ユーザ登録
  ユーザ編集
  プロジェクト一覧
  プロジェクト編集
  ドメイン一覧
  ドメイン登録
  ドメイン編集
  ユビキタス言語一覧
  ユビキタス言語入力・編集
  ユビキタス言語承認
  ```

- **専用機能・操作**:
  ```
  自身が管理者となっているプロジェクトのドメイン登録、編集、削除
  自身が管理者となっているプロジェクトのドメイン承認者登録、編集、削除
  自身が管理者となっているプロジェクトの一般ユーザ登録、編集、削除
  ```

#### ドメイン承認者
- **表示可能画面**:
  ```
  ログイン
  プロフィール変更
  パスワード変更
  パスワードリセットメール送信
  パスワードリセット実行
  ユビキタス言語一覧
  ユビキタス言語入力・編集
  ユビキタス言語承認
  ```

- **専用機能・操作**:
  ```
  自身が承認者となっているドメインのユビキタス言語承認
  ```

#### 一般ユーザー
- **表示可能画面**:
  ```
  ログイン
  プロフィール変更
  パスワード変更
  パスワードリセットメール送信
  パスワードリセット実行
  ユビキタス言語一覧
  ユビキタス言語入力・編集
  ```

- **専用機能・操作**:
  ```
  なし
  ```

### 1.2 UI要素の表示/非表示制御

#### メニュー・ナビゲーション
- **全ユーザー共通で表示**:
  ```
  ログアウト
  ユビキタス言語一覧
  ユビキタス言語入力・編集
  プロフィール変更
  パスワード変更
  ```

- **権限によって表示/非表示**:
  ```
  - ドメイン承認者以上のロールで表示される
    - ユビキタス言語承認
  - プロジェクト管理者以上のロールで表示される
    - ユーザ一覧
    - プロジェクト一覧
    - ドメイン一覧
  ```

#### ボタン・操作要素
- **条件付き表示の詳細**:
  ```
  - プロジェクト一覧
    - スーパーユーザのみ削除操作可能
  - ドメイン一覧
    - プロジェクト管理者以上のロールのみ削除操作可能
  - ユビキタス言語一覧
    - プロジェクト管理者以上のロールのみ表示対象プロジェクト切替可能
  - ユビキタス言語入力・編集
    - ドメイン承認者以上のローのみユビキタス言語削除操作可能
  ```

## 2. 認証・ログイン関連の画面要件

### 2.1 ログイン画面の仕様

#### レイアウト・デザイン
- **画面構成**:
  ```
  シンプルなセンタリングレイアウト
  テーマは落ち着いた配色
  ログインボタンの下部に、パスワードリセットメール送信画面へのリンクを配置
  ```

#### 入力項目・機能
- **必須入力項目**:
  ```
  メールアドレス
  パスワード
  ログイン状態保持チェックボックス
  ```

- **追加機能**:
  ```
  自動ログイン機能あり
  ログイン失敗によるロックアウト機構は設けない
  ```

### 2.2 ユーザー登録画面

#### 登録権限・フロー
- **誰が誰を登録するか**:
  ```
  基本的運用としては、プロジェクト管理者が担当プロジェクトの承認者、一般ユーザを登録する
  スーパーユーザは、プロジェクト管理者と他のスーパーユーザを登録する

  しかしプロジェクト管理者が対応できないケースを考慮して、スーパーユーザは各プロジェクトの承認者、一般ユーザを登録することも可能とする
  ```

- **登録時の入力項目**:
  ```
  - メールアドレス（ログインIdとなる）
  - 初期パスワード
  - 所属プロジェクト
    - スーパーユーザは全プロジェクトから選択可能、プロジェクト管理者は自身が担当プロジェクトのみ選択可能
  - 氏名
  ```

### 2.3 パスワード管理画面

#### パスワード変更機能
- **実装要否**:
  ```
  パスワード変更機能は必要
  ログインユーザ自身のパスワードを変更できる
  初回ログイン時は必須だが、初期データとして登録されたスーパーユーザは不要
  ```

#### パスワードリセット機能
- **実装要否・方法**:
  ```
  パスワードリセット機能は必要
  ログインを試みたユーザがパスワードを失念したしまった場合に利用する
  パスワードリセット機能の流れは以下の通り

  1. ログイン画面からパスワードリセットメール送信画面へ遷移
  2. メールアドレスを入力(ここでユーザ未登録のメールアドレスを入力した場合はエラー)
  3. 受信したメールのリンクから、パスワードリセット実行画面に遷移
  4. リセット後のパスワードを入力
  5. ログイン画面へ遷移
  ```

## 3. 承認ワークフロー画面の詳細

### 3.1 承認待ち一覧画面

#### 表示項目・レイアウト
- **一覧表示項目**:
  ```
  承認待ち一覧画面と呼ばれているが、今後は「ユビキタス言語承認」画面とする。

  表示項目は以下の通り
  - 和名
  - 英名
  - 意味
  - 発生機会
  - 関連用語
  - 備考
  - 却下理由
  - 申請者氏名
  - 申請日時
  ```

- **ソート・フィルタ機能**:
  ```
  - フィルタ機能
    - プロジェクト
    - ドメイン
    - 和名(部分一致)
    - 意味(部分一致)
  - ソート機能
    - 和名
    - 英名
    - 発生機会
    - 申請者氏名
    - 新生日時(画面初期表示時の既定値、降順)
  ```

#### 操作方法
- **承認・却下の操作方法**:
  ```
  - 承認操作
    - 行単位でのボタン操作
    - 複数行チェックボックスを入れた上での一括承認
  - 却下操作
    - 行単位でのボタン操作
    - 複数行チェックボックスを入れた上での一括却下
  ```

### 3.2 承認・却下時の画面フロー

#### 確認・入力画面
- **承認時の確認内容**:
  ```
  - 承認操作を実行するボタン押下時、実行確認ダイアログを表示（承認してよろしいですか？）
  ```

- **却下時の入力項目**:
  ```
  - 却下操作を実行するボタン押下時、実行確認ダイアログを表示
    - ダイアログ上で却下理由を入力した後に却下実行
  ```

### 3.3 通知機能

#### 通知の実装要否・方法
- **画面内通知**:
  ```
  - 画面右下にトースター表示
  - 通知対象者は承認者のみ、プロジェクト管理者以上には通知しない
  - 通知メッセージは"新規承認依頼が届きました。"のみ、具体的な承認依頼内容は不要
  ```

- **メール通知**:
  ```
  不要
  ```

## 4. Claude Code連携画面

### 4.1 出力機能の画面配置

#### メニュー・ボタン配置
- **出力機能へのアクセス方法**:
  ```
  ユビキタス言語一覧画面から「AI向けエクスポート」ボタンで出力する
  出力専用画面は設けない
  ```

- **画面上の配置場所**:
  ```
  アクションボタンエリア
  ```

### 4.2 出力条件設定画面

#### 選択・設定項目
- **プロジェクト選択UI**:
  ```
  不要、ユビキタス言語一覧画面で検索条件に指定されているものを出力する
  
  ユビキタス言語一覧画面のフィルタ条件は以下の通り
  - プロジェクト(ドロップダウンリスト)
  - ドメイン
  - 和名(部分一致)
  - 英名(部分一致)
  - 発生機会
  ```

- **ドメイン絞り込みUI**:
  ```
  ドロップダウンリスト、但し選択候補に「すべてのドメイン」を選択肢に入れる。
  ```

- **その他の出力オプション**:
  ```
  CSV形式の出力
  アクションボタンエリアに配置した「CSVエクスポート」ボタンで出力される。
  ```

### 4.3 出力結果の表示・ダウンロード

#### 出力完了後の処理
- **結果表示方法**:
  ```
  自動的なファイルダウンロードのみ。特に結果通知は不要。
  ```

- **ファイル取得方法**:
  ```
  自動ダウンロード
  ```

## 5. エラーハンドリング・メッセージ表示

### 5.1 競合エラー時の処理

#### 表示内容
- **エラーメッセージの内容**:
  ```
  他のユーザーが同時編集中です。画面を更新してください。
  ```

#### 操作方法
- **ユーザーが取るべき操作**:
  ```
  F5キー等でブラウザ更新する
  ```

### 5.2 バリデーションエラーの表示方式

#### 表示方法・場所
- **エラー表示方式**:
  ```
  エラー項目の上下左右いずれかに吹き出し型ポップアップでメッセージを表示。
  ポップアップは対象のDOMにフォーカスが当たっている場合のみ表示される。
  ポップアップ上のメッセージのColorはFirebrickとする。
  ```

- **エラー内容の詳細度**:
  ```
  メッセージは簡潔に、分かりやすいメッセージとする。
  エラー箇所は薄い赤系の色でハイライト表示する。
  ```

### 5.3 成功・失敗メッセージの表示

#### 表示方法・タイミング
- **成功メッセージ**:
  ```
  画面中央下部にトースター表示する。
  表示時間は5秒間とする。
  ```

- **失敗メッセージ**:
  ```
  画面中央下部にトースター表示する。
  表示時間は5秒間とする。
  ```

---

**記入完了後の確認項目**:
- [x] 全ての項目について具体的な要件を記入した
- [x] 曖昧な表現を避け、実装可能なレベルで詳細化した
- [x] 既存の要件定義書との整合性を確認した
- [x] 追加で必要な確認事項があれば最下部に記載した

**追加の確認事項・コメント**:
```
# 各画面の目的・概要について以下に記載します

- ログイン
  - ログインする
- プロフィール変更
  - ログインユーザの氏名を変更する、後々プロフィール画像等を追加するかもしれません
- パスワード変更
  - ログインユーザのパスワードを変更する
- パスワードリセットメール送信
  - ユーザがパスワードを失念した場合に、パスワードリセット画面へ遷移するリンクを載せたメールを送信する
- パスワードリセット実行
  - パスワードリセットする
- ユーザ一覧
  - システムを利用しているユーザ情報一覧を確認する
  - ユーザ削除はこの画面から実行する
  - ユーザ登録、編集画面にはここから遷移する
  - スーパーユーザは全ユーザを確認可能、プロジェクト管理者は担当しているプロジェクトに属するユーザのみ確認可能
- ユーザ登録
  - 新規ユーザを登録する
- ユーザ編集
  - ユーザ情報を編集する
- プロジェクト一覧
  - システムが管理しているプロジェクトの一覧を確認する
  - プロジェクト削除はこの画面から実行する
  - スーパーユーザは全プロジェクトを確認可能、プロジェクト管理者は担当しているプロジェクトのみ確認可能
- プロジェクト登録
  - 新規プロジェクトを登録する
- プロジェクト編集
  - プロジェクト情報を編集する
- ドメイン一覧
  - システムが管理しているプロジェクトの一覧を確認する
  - プロジェクト削除はこの画面から実行する
  - スーパーユーザは全プロジェクトのドメインを確認可能、プロジェクト管理者は担当しているプロジェクトのドメインのみ確認可能
- ドメイン登録
  - 新規ドメインを登録する
- ドメイン編集
  - ドメイン情報を編集する
- ユビキタス言語一覧
  - 承認済み(つまりは確定済み)のユビキタス言語一覧を確認する
    - 承認待ち、ドラフトのデータはこの画面には表示されない
  - ClaudeCodeに連携するファイルを出力する
  - この画面は検索、ソート、表示機能のみ有する。編集や削除はすべてのロールで一切不可能。
  - スーパーユーザは全プロジェクトのユビキタス言語を確認可能、プロジェクト管理者は担当しているプロジェクトのユビキタス言語のみ確認可能、承認者と一般ユーザは所属しているプロジェクトのユビキタス言語のみ確認可能
  - ログイン直後はこの画面が表示される（ホーム画面扱いとする）
  - 一覧データには以下情報が表示される
    - 和名
    - 英名
    - 意味
    - 発生機会
  - 一覧上の各データをクリックすると、ポップアップ画面で詳細情報（関連用語や備考、変更履歴）等の全データを確認できる
- ユビキタス言語入力・編集
  - 一覧形式で表示しつつ、新規登録や編集、申請、削除を行う
- ユビキタス言語承認
  - 承認/却下操作を行う
  - ここに表示されるのは承認待ちのデータのみ

# 削除について

削除操作はすべてのケースで論理削除とします。
ユビキタス言語一覧画面を除く「○○一覧」画面には、検索条件として「論理削除済みデータを表示する」フィルタ条件を有します。

# デザインコンセプト

見やすさ、使いやすさを重視します。
ユーザはすべてエンジニアとなりますので、そこまで親切な表記は無くても大丈夫です。
```
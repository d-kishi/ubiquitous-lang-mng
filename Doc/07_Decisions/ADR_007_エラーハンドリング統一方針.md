# ADR_007: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€æ–¹é‡

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ‰¿èªæ¸ˆã¿  
**æ±ºå®šæ—¥**: 2025-07-06  
**æ±ºå®šè€…**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼  
**è¨˜éŒ²è€…**: Claude Code  

## èƒŒæ™¯ãƒ»èª²é¡Œ

### Clean Architectureã§ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®è¤‡é›‘æ€§
- **å±¤åˆ¥è²¬å‹™**: Domainã€Applicationã€Infrastructureã€Presentationã®å„å±¤ã§ç•°ãªã‚‹ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¿…è¦
- **ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥**: ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«é•åï¼ˆDomainï¼‰vs æŠ€è¡“çš„ã‚¨ãƒ©ãƒ¼ï¼ˆInfrastructureï¼‰ã®æ˜ç¢ºãªåˆ†é›¢
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æä¾›

### F#é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ´»ç”¨
- **Resultå‹**: F#ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ã‹ã—ãŸå …ç‰¢ãªã‚¨ãƒ©ãƒ¼å‡¦ç†
- **ä¾‹å¤–å›é¿**: äºˆæ¸¬å¯èƒ½ãªã‚¨ãƒ©ãƒ¼ã¯ä¾‹å¤–ã§ã¯ãªãå‹ã§è¡¨ç¾
- **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ä¿è¨¼**: ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®å¼·åˆ¶ã«ã‚ˆã‚‹å®Ÿè¡Œæ™‚ä¾‹å¤–å‰Šæ¸›

### ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªç®¡ç†ã®æ¥­å‹™ç‰¹æ€§
- **æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**: çŠ¶æ…‹é·ç§»ã®åˆ¶ç´„é•å
- **ç”¨èªé‡è¤‡ãƒã‚§ãƒƒã‚¯**: ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«é•å
- **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: å‚ç…§æ•´åˆæ€§åˆ¶ç´„é•å

## æ±ºå®šäº‹é …

## 1. **å±¤åˆ¥ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥**

### 1.1 Domainå±¤ (F#) - ãƒ“ã‚¸ãƒã‚¹ã‚¨ãƒ©ãƒ¼å‡¦ç†
```fsharp
// âœ… ãƒ“ã‚¸ãƒã‚¹ã‚¨ãƒ©ãƒ¼ã®å‹å®šç¾©
type UbiquitousLangValidationError = 
    | UbiquitousLangNotFound of ubiquitousLangId: Guid
    | InvalidStatusTransition of current: UbiquitousLangStatus * attempted: UbiquitousLangStatus
    | DuplicateUbiquitousLangName of name: string * projectId: int
    | EmptyUbiquitousLangName
    | InvalidProjectAssignment of ubiquitousLangId: Guid * projectId: int

type ApprovalWorkflowError =
    | InsufficientPermissions of userId: int * requiredRole: UserRole
    | WorkflowNotFound of workflowId: Guid
    | InvalidApprovalTransition of current: ApprovalStatus * attempted: ApprovalStatus

// âœ… Resultå‹ã«ã‚ˆã‚‹æ˜ç¤ºçš„ã‚¨ãƒ©ãƒ¼å‡¦ç†
let validateUbiquitousLangCreation (ubiquitousLang: CreateUbiquitousLangCommand) : Result<ValidatedUbiquitousLang, UbiquitousLangValidationError> =
    if String.IsNullOrWhiteSpace(ubiquitousLang.Name) then
        Error EmptyUbiquitousLangName
    elif isDuplicateUbiquitousLang ubiquitousLang.Name ubiquitousLang.ProjectId then
        Error (DuplicateUbiquitousLangName(ubiquitousLang.Name, ubiquitousLang.ProjectId))
    else
        Ok { 
            Name = ubiquitousLang.Name.Trim()
            ProjectId = ubiquitousLang.ProjectId
            Description = ubiquitousLang.Description 
        }

// âœ… çŠ¶æ…‹é·ç§»ã®æ¤œè¨¼
let validateStatusTransition (current: UbiquitousLangStatus) (next: UbiquitousLangStatus) : Result<unit, UbiquitousLangValidationError> =
    match current, next with
    | Draft, UnderReview -> Ok ()
    | UnderReview, Approved -> Ok ()
    | UnderReview, Rejected -> Ok ()
    | Rejected, Draft -> Ok ()
    | _ -> Error (InvalidStatusTransition(current, next))
```

**Domainå±¤ã®åŸå‰‡**:
- **ä¾‹å¤–ç¦æ­¢**: äºˆæ¸¬å¯èƒ½ãªãƒ“ã‚¸ãƒã‚¹ã‚¨ãƒ©ãƒ¼ã¯ä¾‹å¤–ã‚’ä½¿ç”¨ã—ãªã„
- **Resultå‹å¿…é ˆ**: `Result<'T, 'Error>`ã§ã‚¨ãƒ©ãƒ¼ã‚’å‹ã‚·ã‚¹ãƒ†ãƒ ã«çµ„ã¿è¾¼ã‚€
- **åˆ¤åˆ¥å…±ç”¨ä½“**: ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥ã‚’å…·ä½“çš„ã«è¡¨ç¾
- **ç´”ç²‹é–¢æ•°**: å¤–éƒ¨I/Oï¼ˆãƒ­ã‚°ç­‰ï¼‰ã«ä¾å­˜ã—ãªã„

### 1.2 Applicationå±¤ (F#) - ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼å‡¦ç†
```fsharp
type ApplicationError =
    | DomainError of UbiquitousLangValidationError
    | AuthorizationError of string
    | InfrastructureError of string
    | ConcurrencyError of string

// âœ… ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã®ã‚¨ãƒ©ãƒ¼é›†ç´„
let createUbiquitousLangUseCase (command: CreateUbiquitousLangCommand) (currentUser: User) : Result<UbiquitousLangDto, ApplicationError> =
    result {
        // èªå¯ãƒã‚§ãƒƒã‚¯
        do! validateUserPermission currentUser command.ProjectId
            |> Result.mapError AuthorizationError
        
        // ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        let! validatedUbiquitousLang = validateUbiquitousLangCreation command
            |> Result.mapError DomainError
        
        // æ°¸ç¶šåŒ–
        let! savedUbiquitousLang = repository.SaveAsync validatedUbiquitousLang
            |> Result.mapError InfrastructureError
        
        // DTOã¸ã®å¤‰æ›
        return UbiquitousLangConverters.ToDto savedUbiquitousLang
    }
```

**Applicationå±¤ã®åŸå‰‡**:
- **ã‚¨ãƒ©ãƒ¼é›†ç´„**: Domainã€Infrastructureã€èªå¯ã‚¨ãƒ©ãƒ¼ã‚’çµ±åˆ
- **è¨ˆç®—å¼**: F#ã®resultè¨ˆç®—å¼ã§è¤‡æ•°ã‚¨ãƒ©ãƒ¼ã‚’é€£é–å‡¦ç†
- **å‹å¤‰æ›**: F#ã‚¨ãƒ©ãƒ¼å‹ã‹ã‚‰C#ã§æ‰±ã„ã‚„ã™ã„å½¢å¼ã«å¤‰æ›æº–å‚™

### 1.3 Infrastructureå±¤ (C#) - æŠ€è¡“çš„ã‚¨ãƒ©ãƒ¼å‡¦ç†
```csharp
// âœ… Infrastructureå±¤ã§ã®ä¾‹å¤–å‡¦ç†
public class UbiquitousLangRepository : IUbiquitousLangRepository
{
    /// <summary>
    /// ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã—ã¾ã™
    /// </summary>
    /// <param name="ubiquitousLang">ä¿å­˜ã™ã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</param>
    /// <returns>ä¿å­˜çµæœ</returns>
    /// <exception cref="DbConcurrencyException">æ¥½è¦³çš„æ’ä»–åˆ¶å¾¡é•åæ™‚</exception>
    /// <exception cref="SqlException">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚</exception>
    public async Task<Result<UbiquitousLang>> SaveAsync(UbiquitousLang ubiquitousLang)
    {
        try
        {
            using var context = _contextFactory.CreateDbContext();
            
            // ğŸ”§ EF Core: ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å¤‰æ›ã¨ä¿å­˜
            var entity = UbiquitousLangConverters.ToEntity(ubiquitousLang);
            context.UbiquitousLangs.Add(entity);
            
            await context.SaveChangesAsync();
            
            var savedDomain = UbiquitousLangConverters.ToDomain(entity);
            return Result<UbiquitousLang>.Success(savedDomain);
        }
        catch (DbUpdateConcurrencyException ex)
        {
            // ğŸ¯ æ¥½è¦³çš„æ’ä»–åˆ¶å¾¡: ãƒ“ã‚¸ãƒã‚¹çš„æ„å‘³ã®ã‚ã‚‹ã‚¨ãƒ©ãƒ¼
            return Result<UbiquitousLang>.Failure($"ãƒ‡ãƒ¼ã‚¿ãŒä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦æ›´æ–°ã•ã‚Œã¾ã—ãŸ: {ex.Message}");
        }
        catch (SqlException ex) when (ex.Number == 2) // Timeout
        {
            // ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ã‚¨ãƒ©ãƒ¼
            return Result<UbiquitousLang>.Failure("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚");
        }
        catch (Exception ex)
        {
            // âš ï¸ äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…å‘ã‘è©³ç´°æƒ…å ±
            return Result<UbiquitousLang>.Failure($"ãƒ‡ãƒ¼ã‚¿ä¿å­˜ä¸­ã«äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}");
        }
    }
}
```

**Infrastructureå±¤ã®åŸå‰‡**:
- **ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒ**: æŠ€è¡“çš„ãªä¾‹å¤–ã‚’Resultã«å¤‰æ›
- **å…·ä½“çš„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- **ä¾‹å¤–ç¨®åˆ¥åˆ¤å®š**: ç‰¹å®šä¾‹å¤–ã«å¿œã˜ãŸé©åˆ‡ãªãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 1.4 Presentationå±¤ (Blazor Server) - UIã‚¨ãƒ©ãƒ¼è¡¨ç¤º
```csharp
// âœ… Blazor Serverã§ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
public partial class UbiquitousLangManagementComponent : ComponentBase
{
    [Inject] private IUbiquitousLangService UbiquitousLangService { get; set; } = default!;
    
    private string? _errorMessage;
    private string? _successMessage;
    
    private async Task OnCreateUbiquitousLangAsync()
    {
        try
        {
            // âš¡ UIçŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ: å‰å›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¯ãƒªã‚¢
            _errorMessage = null;
            _successMessage = null;
            
            var command = new CreateUbiquitousLangCommand 
            { 
                Name = _newUbiquitousLangName, 
                ProjectId = _selectedProjectId 
            };
            
            // ğŸ¯ Applicationå±¤å‘¼ã³å‡ºã—: çµæœã®Resultå‹å‡¦ç†
            var result = await UbiquitousLangService.CreateUbiquitousLangAsync(command);
            
            if (result.IsSuccess)
            {
                // âœ… æˆåŠŸæ™‚: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ç”»é¢æ›´æ–°
                _successMessage = "ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚";
                _newUbiquitousLangName = string.Empty;
                await LoadUbiquitousLangsAsync();
            }
            else
            {
                // âŒ å¤±æ•—æ™‚: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼è¡¨ç¤º
                _errorMessage = TranslateErrorMessage(result.Error);
            }
            
            // ğŸ”„ Blazor Server: UIæ›´æ–°é€šçŸ¥
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // âš ï¸ äºˆæœŸã—ãªã„ä¾‹å¤–: ã‚°ãƒ­ãƒ¼ãƒãƒ«ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒ©ã§å‡¦ç†
            _errorMessage = "ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚";
            
            // ğŸ“ ãƒ­ã‚°å‡ºåŠ›: è©³ç´°ãªã‚¨ãƒ©ãƒ¼æƒ…å ±ï¼ˆåˆ¥é€”ãƒ­ã‚°æŒ‡é‡ã§å®šç¾©ï¼‰
            Logger.LogError(ex, "UbiquitousLang creation failed unexpectedly");
            StateHasChanged();
        }
    }
    
    /// <summary>
    /// ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªæ—¥æœ¬èªã«å¤‰æ›
    /// </summary>
    private string TranslateErrorMessage(string error)
    {
        // ğŸ¯ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ—¥æœ¬èªåŒ–ã¨ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
        return error switch
        {
            var msg when msg.Contains("DuplicateUbiquitousLangName") => "ã“ã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªåã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™ã€‚åˆ¥ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
            var msg when msg.Contains("EmptyUbiquitousLangName") => "ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
            var msg when msg.Contains("InsufficientPermissions") => "ã“ã®æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
            var msg when msg.Contains("InvalidStatusTransition") => "ç¾åœ¨ã®çŠ¶æ…‹ã‹ã‚‰ã“ã®æ“ä½œã¯å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚",
            _ => "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
        };
    }
}
```

**Presentationå±¤ã®åŸå‰‡**:
- **Resultå‹å‡¦ç†**: Applicationå±¤ã‹ã‚‰ã®Resultå‹ã‚’é©åˆ‡ã«å‡¦ç†
- **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: æŠ€è¡“çš„ã‚¨ãƒ©ãƒ¼ã‚’åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›
- **UIçŠ¶æ…‹ç®¡ç†**: ã‚¨ãƒ©ãƒ¼ãƒ»æˆåŠŸçŠ¶æ…‹ã®é©åˆ‡ãªè¡¨ç¤ºãƒ»ã‚¯ãƒªã‚¢
- **ã‚°ãƒ­ãƒ¼ãƒãƒ«ä¾‹å¤–**: äºˆæœŸã—ãªã„ä¾‹å¤–ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†

## 2. **å…±é€šã‚¨ãƒ©ãƒ¼å‹å®šç¾©**

### 2.1 Resultå‹ï¼ˆContracts Layerï¼‰
```csharp
// âœ… C#å´Resultå‹ - F#ã‹ã‚‰ã®å‹å¤‰æ›ç”¨
public class Result<T>
{
    public bool IsSuccess { get; init; }
    public T? Value { get; init; }
    public string? Error { get; init; }
    public string? ErrorCode { get; init; }
    
    public static Result<T> Success(T value) => new() 
    { 
        IsSuccess = true, 
        Value = value 
    };
    
    public static Result<T> Failure(string error, string? errorCode = null) => new() 
    { 
        IsSuccess = false, 
        Error = error, 
        ErrorCode = errorCode 
    };
}

public class Result
{
    public bool IsSuccess { get; init; }
    public string? Error { get; init; }
    public string? ErrorCode { get; init; }
    
    public static Result Success() => new() { IsSuccess = true };
    public static Result Failure(string error, string? errorCode = null) => new() 
    { 
        IsSuccess = false, 
        Error = error, 
        ErrorCode = errorCode 
    };
}
```

### 2.2 ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»
```csharp
// âœ… ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šæ•° - ãƒ­ã‚°ãƒ»ç›£è¦–ã§ã®æ´»ç”¨
public static class ErrorCodes
{
    // Domain Errors (1000ç•ªå°)
    public const string UBIQUITOUS_LANG_NOT_FOUND = "ULANG_1001";
    public const string DUPLICATE_UBIQUITOUS_LANG_NAME = "ULANG_1002";
    public const string INVALID_STATUS_TRANSITION = "ULANG_1003";
    public const string EMPTY_UBIQUITOUS_LANG_NAME = "ULANG_1004";
    
    // Authorization Errors (2000ç•ªå°)
    public const string INSUFFICIENT_PERMISSIONS = "AUTH_2001";
    public const string USER_NOT_FOUND = "AUTH_2002";
    public const string INVALID_PROJECT_ACCESS = "AUTH_2003";
    
    // Infrastructure Errors (3000ç•ªå°)
    public const string DATABASE_CONNECTION_FAILED = "INFRA_3001";
    public const string CONCURRENCY_CONFLICT = "INFRA_3002";
    public const string EXTERNAL_API_UNAVAILABLE = "INFRA_3003";
    
    // System Errors (9000ç•ªå°)
    public const string UNEXPECTED_ERROR = "SYS_9001";
    public const string CONFIGURATION_ERROR = "SYS_9002";
}
```

## 3. **ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³**

### 3.1 F#ã§ã®ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒ¼ãƒ³å‡¦ç†
```fsharp
// âœ… Railway-oriented Programming ãƒ‘ã‚¿ãƒ¼ãƒ³
let processUbiquitousLangWorkflow (command: CreateUbiquitousLangCommand) (user: User) =
    validateUser user
    |> Result.bind (fun _ -> validateUbiquitousLangCommand command)
    |> Result.bind (fun validUbiquitousLang -> checkDuplicates validUbiquitousLang)
    |> Result.bind (fun validUbiquitousLang -> createUbiquitousLang validUbiquitousLang)
    |> Result.bind (fun ubiquitousLang -> startApprovalWorkflow ubiquitousLang user)
    |> Result.map (fun workflow -> UbiquitousLangWorkflowDto.FromDomain workflow)
```

### 3.2 C#ã§ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³
```csharp
// âœ… Application Serviceã§ã®çµ±åˆã‚¨ãƒ©ãƒ¼å‡¦ç†
public async Task<Result<UbiquitousLangDto>> CreateUbiquitousLangAsync(CreateUbiquitousLangCommand command)
{
    // ğŸ”§ F#ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å‘¼ã³å‡ºã—
    var domainResult = _domainService.CreateTerm(command);
    
    if (!domainResult.IsSuccess)
    {
        // âŒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼: F#ã‚¨ãƒ©ãƒ¼å‹ã‹ã‚‰C#ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›
        return Result<TermDto>.Failure(
            TranslateDomainError(domainResult.Error), 
            GetErrorCode(domainResult.Error)
        );
    }
    
    try
    {
        // ğŸ¯ Infrastructureå‡¦ç†: ä¾‹å¤–ã®å¯èƒ½æ€§ã‚ã‚Š
        var savedUbiquitousLang = await _repository.SaveAsync(domainResult.Value);
        return Result<UbiquitousLangDto>.Success(UbiquitousLangDto.FromDomain(savedUbiquitousLang));
    }
    catch (Exception ex)
    {
        // âš ï¸ Infrastructureä¾‹å¤–: Resultå‹ã«å¤‰æ›
        return Result<UbiquitousLangDto>.Failure(
            $"ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}",
            ErrorCodes.DATABASE_CONNECTION_FAILED
        );
    }
}
```

## æŠ€è¡“çš„æ ¹æ‹ 

### Resultå‹æ¡ç”¨ã®åˆ©ç‚¹
1. **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨ãƒ©ãƒ¼å‡¦ç†å¼·åˆ¶**: ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®å‡¦ç†å¿˜ã‚Œã‚’é˜²æ­¢
2. **ä¾‹å¤–æ€§èƒ½ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å›é¿**: åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã§ã®ä¾‹å¤–ä½¿ç”¨ã‚’å‰Šæ¸›
3. **å‹å®‰å…¨æ€§**: ã‚¨ãƒ©ãƒ¼å†…å®¹ãŒå‹ã‚·ã‚¹ãƒ†ãƒ ã§è¡¨ç¾ã•ã‚Œã‚‹

### å±¤åˆ¥ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®åˆ©ç‚¹
1. **é–¢å¿ƒäº‹ã®åˆ†é›¢**: å„å±¤ãŒé©åˆ‡ãªè²¬å‹™ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†
2. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: æŠ€è¡“çš„è©³ç´°ã‚’éš è”½ã—ãŸåˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
3. **ä¿å®ˆæ€§**: ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ã®é›†ç´„ã¨ä¸€å…ƒç®¡ç†

### F#é–¢æ•°å‹ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®åˆ©ç‚¹
1. **Railway-oriented Programming**: ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®æ˜ç¤ºçš„ãªãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
2. **ç´”ç²‹é–¢æ•°**: ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“ã§äºˆæ¸¬å¯èƒ½ãªã‚¨ãƒ©ãƒ¼å‡¦ç†
3. **å‹å®‰å…¨æ€§**: åˆ¤åˆ¥å…±ç”¨ä½“ã«ã‚ˆã‚‹å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ç¨®åˆ¥è¡¨ç¾

## å®Ÿè£…å½±éŸ¿

### é–‹ç™ºåŠ¹ç‡ã¸ã®å½±éŸ¿
- **åˆæœŸå­¦ç¿’ã‚³ã‚¹ãƒˆ**: Resultå‹ãƒ»åˆ¤åˆ¥å…±ç”¨ä½“ã®ç¿’å¾—ãŒå¿…è¦
- **é•·æœŸãƒ¡ãƒªãƒƒãƒˆ**: ãƒ‡ãƒãƒƒã‚°æ™‚é–“çŸ­ç¸®ã€ãƒã‚°ç™ºç”Ÿç‡å‰Šæ¸›

### ã‚·ã‚¹ãƒ†ãƒ å“è³ªã¸ã®å½±éŸ¿
- **å …ç‰¢æ€§å‘ä¸Š**: äºˆæœŸã—ãªã„ä¾‹å¤–ã®å¤§å¹…å‰Šæ¸›
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚ˆã‚‹ä½¿ã„ã‚„ã™ã•å‘ä¸Š

## é–¢é€£ADR

- **ADR_010**: å®Ÿè£…è¦ç´„ï¼ˆF#ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ãƒ»Resultå‹æ´»ç”¨ï¼‰
- **ADR_008**: ãƒ­ã‚°å‡ºåŠ›æŒ‡é‡ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å‡ºåŠ›ãƒ¬ãƒ™ãƒ«ãƒ»å†…å®¹ï¼‰
- **ADR_003**: ç”¨èªçµ±ä¸€ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚‚ã€Œãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã€è¡¨è¨˜ï¼‰

## ãƒ¬ãƒ“ãƒ¥ãƒ¼å±¥æ­´

| æ—¥ä»˜ | ãƒ¬ãƒ“ãƒ¥ãƒ¼è€… | çµæœ | ã‚³ãƒ¡ãƒ³ãƒˆ |
|------|------------|------|----------|
| 2025-07-06 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼ | æ‰¿èª | F# Resultå‹æ´»ç”¨ã¨Clean Architectureå±¤åˆ¥è²¬å‹™ãŒé©åˆ‡ |

---

**æ‰¿èªè€…**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼  
**æ‰¿èªæ—¥**: 2025-07-06  
**æœ‰åŠ¹æœŸé–“**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºå…¨ä½“  
**æ¬¡å›è¦‹ç›´ã—**: å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†æ™‚
# ADR-001: Mermaid記法による図表記述の採用

**ステータス**: 採用  
**決定日**: 2025-06-29  
**決定者**: プロジェクトオーナー、Claude Code  

## 背景・課題

### 現状の図表表現の課題
- ASCII アートによる画面設計表現の限界
- システム設計における複雑なフロー・関係性の表現困難
- ユーザーストーリーでのユーザージャーニー図化の必要性
- バージョン管理における図表の管理の困難さ

### 検討された選択肢
1. **draw.io（diagrams.net）**: 外部ツールによる図表作成
2. **Figma**: 高解像度UI設計ツール
3. **Mermaid記法**: テキストベースの図表記述
4. **A5:SQL Mk-2**: ER図専用ツール

## 決定内容

### Mermaid記法を主要な図表記述方法として採用

**対象範囲**:
- システム内部の論理構造・フロー・シーケンス図
- ユーザージャーニー図
- アーキテクチャ図
- データフロー図
- API シーケンス図

**使い分け方針**:
- **Mermaid**: システム内部の論理構造・フロー・関係性
- **draw.io**: 画面イメージ・ワイヤーフレーム・画面遷移図（将来対応）
- **A5:SQL**: ER図（補完的利用）

## 理由・根拠

### 採用理由
1. **テキストベース管理**: Markdownファイル内に直接記述可能
2. **バージョン管理対応**: Gitで図の変更履歴も管理できる
3. **保守性**: 外部ファイルに依存しない
4. **多様な図対応**: フローチャート、シーケンス図、ユーザージャーニー図等
5. **GitHub/VS Code対応**: 標準的な開発環境での図表プレビュー機能

### 技術的メリット
- コードレビューで図の変更も同時にレビュー可能
- 文書と図の整合性維持が容易
- CI/CDパイプラインでの図表検証可能
- 検索性：図の内容もテキスト検索対象

## 適用箇所

### 高優先度（即座に適用）
1. **ユーザーストーリー.md**: ユーザージャーニー図、ストーリーマップ
2. **システム設計書.md**: アーキテクチャ図、データフロー図

### 中優先度（設計フェーズで適用）
3. **データベース設計書.md**: エンティティ関連図、データライフサイクル図
4. **API設計書.md**: APIシーケンス図、認証フロー図

### 低優先度（運用フェーズで適用）
5. **ADR**: 技術選定比較図、アーキテクチャ変更図

## 実装方針

### 記述ルール
- Mermaid記法はMarkdownのコードブロックで記述
- 図のタイトル・説明は図の前後に日本語で記述
- 複雑な図は複数の小さな図に分割

### 品質管理
- 図の論理的正確性の確保
- 適切なラベル・説明の追加
- 図の可読性・理解しやすさの重視

## 代替案との比較

| 観点 | Mermaid | draw.io | Figma | A5:SQL |
|------|---------|---------|-------|---------|
| バージョン管理 | ○ | △ | △ | △ |
| 保守性 | ○ | △ | △ | ○ |
| 学習コスト | ○ | ○ | △ | ○ |
| 表現力 | ○ | ◎ | ◎ | △ |
| 開発統合 | ◎ | △ | × | △ |

## 影響・リスク

### 正の影響
- 図表管理の効率化
- 文書品質の向上
- 開発プロセスとの統合

### 潜在的リスク
- 複雑な図の表現限界
- 学習コストの発生

### リスク軽減策
- 段階的導入による学習支援
- 複雑図のdraw.io併用

---

**関連決定**: なし  
**次回レビュー**: 2025-09-29（3ヶ月後）  
**記録者**: Claude Code
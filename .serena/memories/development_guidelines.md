# 開発ガイドライン - 2025-09-04更新

## 重要プロセス遵守原則（ADR_016）

### 絶対遵守原則
- **コマンド = 契約**: 一字一句を法的契約として遵守・例外なし
- **承認 = 必須**: 「ユーザー承認」表記は例外なく取得・勝手な判断禁止
- **手順 = 聖域**: 定められた順序の変更禁止・先回り作業禁止

### 禁止違反行為（重大）
- ❌ **承認前作業開始**: いかなる理由でも禁止
- ❌ **独断判断**: 「効率化」理由での勝手作業
- ❌ **成果物虚偽報告**: 実体のない成果物報告
- ❌ **コマンド手順無視**: phase-start/step-start等手順飛ばし

### 必須実行事項
- ✅ **実体確認**: SubAgent成果物の物理的存在確認
- ✅ **承認記録**: 取得承認の明示的記録
- ✅ **チェックリスト実行**: 組織管理運用マニュアルプロセス遵守チェック

## SubAgent統合パターン（実証済み効果）

### 統合テストパターン（Phase A8 Step5実証）
- **integration-test SubAgent**: 複雑テスト修正の並列処理
- **結果**: DbContext→UserManagerパターン成功解決
- **効果**: 67%→100%テスト成功率改善

### 仕様準拠パターン
- **spec-compliance SubAgent**: 自動仕様準拠確認
- **品質スコア**: 95/100点達成
- **統合**: 実ログイン検証 + 包括的テスト実行

### 並列実行最適化
- **複数SubAgent実行**: 同時問題解決
- **効率**: 並列実行による30%工数削減
- **品質**: 自動品質保証 + 一貫性確認

## F# Domain統合ガイドライン

### TypeConverter統合（580行実装）
- **目的**: Clean ArchitectureにおけるF#/C#境界管理
- **パターン**: Contracts層TypeConverterによるシームレス統合
- **達成**: Phase B1移行基盤完了

### F# Domain層実装アプローチ
- **ビジネスルール**: パターンマッチング + Option型 + Result型活用
- **バリデーション**: 包括的エラーハンドリングによる関数型アプローチ
- **統合**: TypeConverter経由でC# Infrastructure層とのシームレス接続

## テスト駆動開発基準

### Red-Green-Refactorサイクル
- **Red**: テスト先行・失敗確認
- **Green**: テスト成功のための最小実装
- **Refactor**: テスト成功維持でのコード改善

### 統合テスト基準
- **UserManagerパターン**: ASP.NET Core Identity統合で同一スコープ使用
- **TestWebApplicationFactory**: 統合テストの標準パターン
- **データベース統合**: PostgreSQL Dockerコンテナ活用

## コード品質基準

### 必須品質基準
- **0警告・0エラー**: 本番品質状態維持
- **テストカバレッジ**: 95%以上カバレッジ維持
- **実動作確認**: 実際ログイン機能確認必須

### セキュリティガイドライン
- **パスワード管理**: UserManager統合・平文保存禁止
- **認証フロー**: ASP.NET Core Identity完全活用
- **HTTPS強制**: 本番環境セキュリティ準拠

## Blazor Server開発ガイドライン

### コンポーネントライフサイクル管理
- **StateHasChanged**: 明示的UI更新制御
- **SignalR統合**: リアルタイム機能実装
- **HTTP文脈分離**: AuthApiControllerパターンによるAPIエンドポイント分離

### F#初学者対応（重要）
- **詳細コメント**: パターンマッチング・Option型・Result型概念説明
- **ビジネスロジック説明**: ドメインモデル設計根拠明確文書化
- **統合例**: 具体的F#/C#連携例提供

## セッション管理プロセス

### セッション開始プロセス
1. **session-start Command**: 自動実行
2. **Serena MCP初期化**: `mcp__serena__check_onboarding_performed`必須
3. **必須ファイル読み込み**: CLAUDE.md・組織管理運用マニュアル・Phase状況
4. **プロセス遵守チェック**: 実行手順確認

### セッション終了プロセス（実証パターン）
1. **目的達成確認**: 具体的指標での定量評価
2. **結果記録**: 具体的成果物 + 技術的知見 + 問題解決記録
3. **日次記録作成**: `/Doc/04_Daily/YYYY-MM/`詳細セッション記録
4. **プロジェクト状況更新**: `/Doc/プロジェクト状況.md`現状反映
5. **Serenaメモリー更新**: 5種類必須（project_overview・development_guidelines・tech_stack_and_conventions・session_insights・task_completion_checklist）

## 品質保証Command

### 必須Command実行
- **step-end-review**: 包括的品質・進捗確認
- **spec-compliance-check**: 仕様準拠監査（95/100点達成）
- **tdd-practice-check**: TDD実践確認

### 品質評価基準
- **仕様準拠**: 95点以上目標
- **実装品質**: 85点以上目標
- **プロセス品質**: 組織管理運用マニュアル100%準拠

## 技術負債管理

### 解決パターン（Phase A8達成）
- **TECH-002**: 初期パスワード不整合 → UserManager統合完全解決
- **TECH-006**: Headers読み取り専用エラー → HTTP文脈分離根本解決
- **予防**: GitHub Issues管理・ADR文書化・体系的アプローチ

### 継続管理
- **GitHub Issue統合**: 技術負債体系的追跡
- **Phase統合**: 関連機能実装時解決
- **効率最適化**: 統合対応 vs 独立対応効率考慮
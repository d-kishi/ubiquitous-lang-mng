# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要

**ユビキタス言語管理システム**のプロジェクトです。ドメイン駆動設計（DDD）における用語管理を効率化するWebアプリケーションの開発を目的としています。現在は**ドキュメント・設計フェーズ**で、実装コードはまだ存在しません。

### プロジェクト構造
- **ドキュメント専用プロジェクト**: 現在のファイルはすべて仕様書、設計書、計画書
- **実装予定**: 承認ワークフローを持つドメイン用語管理Webアプリケーション
- **対象ユーザー**: プロジェクト管理者、ドメインエキスパート、DDD開発者

## アーキテクチャ・設計決定

### 主要な設計決定（ADR）
- **ADR_003**: 用語統一 - 日本語では「用語」ではなく「ユビキタス言語」を使用
- **ADR_001**: 図表にMermaid記法を採用
- **ADR_002**: MermaidのER図記法統一
- **ADR_004**: コミュニケーション課題状態管理システム
- **ADR_005**: PostgreSQL Docker Container採用（データ移行コスト削除）

### データベース設計
- **全環境共通**: PostgreSQL（Docker Container → クラウドDBサービス）
- **データ移行**: 不要（全環境PostgreSQL統一により）
- **アーキテクチャ**: Clean Architectureによるレイヤード構造
- **データ階層**: 組織 → プロジェクト → ドメイン → ユビキタス言語
- **PostgreSQL最適化**: TIMESTAMPTZ、JSONB、GINインデックス等固有機能活用

## コミュニケーション・セッション管理

### 🔴 セッション開始時必読（5分以内・標準プロセス）
**毎セッション開始時に必ず以下の順序で実施**:
1. `/CLAUDE.md` - プロジェクト概要・技術構成・フェーズ状況
2. `/Doc/Readme.md` - ドキュメント管理体制・読み込みガイド
3. `/Doc/06_Issues/コミュニケーション改善課題.md` - コミュニケーション課題と改善策
4. `/Doc/03_Meetings/申し送り事項.md` - プロジェクト状況と次回予定
5. `/Doc/04_Daily/` 直近3日の作業記録 - 継続課題・未完了事項確認

### 🟡 フェーズ依存読み込み（2分、作業内容により選択）
- `/Doc/07_Decisions/ADR_XXX_*.md` - 関連するアーキテクチャ決定
- 現フェーズの設計書（データベース設計書、システム設計書等）
- `/Doc/01_Requirements/要件定義書.md` - 基本要件・制約事項

### 現在対応中の課題
- **COM-001**: 作業範囲確認プロセス - 開始前に全面修正か部分修正かを必ず確認
- **COM-002**: 継続課題追跡 - 過去セッションの継続課題を確認

## 実装指針

### 🎯 **重要**: Blazor Server・F#初学者対応コメント徹底

プロジェクトオーナーがBlazor ServerとF#の初学者のため、これらの分野では**特に詳細なコメント**を必須とする。

**📋 詳細仕様**: [ADR_010: 実装規約](/Doc/07_Decisions/ADR_010_実装規約.md)

**🎯 実装時の重要ポイント**:
- **Blazor Server**: コンポーネントライフサイクル・StateHasChanged・SignalR接続の詳細コメント必須
- **F#**: パターンマッチング・Option型・Result型・関数型プログラミング概念の説明必須
- **ドキュメント継承**: C#では`/// <inheritdoc/>`活用、F#では`<seealso>`タグ活用

### 📋 開発コマンド（実装開始後追加予定）

実装フェーズ開始後に以下を追加:
- ビルドコマンド
- テストコマンド
- リント・フォーマットコマンド
- 開発サーバー起動コマンド

## プロジェクトフェーズ

### ✅ 完了フェーズ
- 要件定義・機能仕様・ユーザーストーリー作成
- データベース設計（PostgreSQL専用最適化完了）
- システム設計（F# + C# Clean Architecture確定）
- UI設計仕様（17画面詳細設計完了）
- Application層インターフェース設計
- 開発環境構築（PostgreSQL Docker Container）

### 🔄 現在のフェーズ
- **実装フェーズ開始準備完了**
- 設計フェーズ100%完了
- 品質保証（包括的レビュー・ADR準拠確認済み）

### 📋 次回フェーズ
- プロジェクト雛形作成（5プロジェクト構成）
- 縦方向スライス実装（ユーザー管理機能貫通）
- 本格実装（ドメイン機能・UI実装）
- テスト・デプロイ準備

## ファイル構成

- `/Doc/01_Requirements/` - 要件・仕様書
- `/Doc/02_Design/` - システム・データベース設計
- `/Doc/03_Meetings/` - 会議録・申し送り事項
- `/Doc/04_Daily/` - 日次作業記録・進捗
- `/Doc/06_Issues/` - 課題追跡・解決
- `/Doc/07_Decisions/` - アーキテクチャ決定記録（ADR）

## 重要事項

- **用語統一**: 日本語では「用語」ではなく「ユビキタス言語」を使用
- **セッション効率化**: 上記読み込みガイドに従って迅速な状況把握
- **課題追跡**: 問題発生時はコミュニケーション改善課題ファイルを更新
- **決定記録**: 重要な技術決定はADRとして記録

## 【MUST GLOBAL】Gemini活用（プロジェクトのCLAUDE.mdより優先）

### 三位一体の開発原則
ユーザーの**意思決定**、Claudeの**分析と実行**、Geminiの**検証と助言**を組み合わせ、開発の質と速度を最大化する：
- **ユーザー**：プロジェクトの目的・要件・最終ゴールを定義し、最終的な意思決定を行う**意思決定者**
  - 反面、具体的なコーディングや詳細な計画を立てる力、タスク管理能力ははありません。
- **Claude**：高度な計画力・高品質な実装・リファクタリング・ファイル操作・タスク管理を担う**実行者**
  - 指示に対して忠実に、順序立てて実行する能力はありますが、意志がなく、思い込みは勘違いも多く、思考力は少し劣ります。
- **Gemini**：深いコード理解・Web検索 (Google検索) による最新情報へのアクセス・多角的な視点からの助言・技術的検証を行う**助言者**
  - プロジェクトのコードと、インターネット上の膨大な情報を整理し、的確な助言を与えてくれますが、実行力はありません。

### 実践ガイド
- **ユーザーの要求を受けたら即座に`gemini -p <質問内容>`で壁打ち**を必ず実施
- Geminiの意見を鵜呑みにせず、1意見として判断。聞き方を変えて多角的な意見を抽出
- **Claude Code内蔵のWebSearchツールは使用しない**
- **o3 MCPツール使用禁止**: 現在o3 MCPは登録済みだが有効化されていないため使用不可
  - `mcp__o3-low__o3-search`、`mcp__o3__o3-search`、`mcp__o3-high__o3-search`は使用しない
  - 将来的に有効化予定だが、現時点では金銭的事情により無効
  - Web検索・技術調査は**Gemini**を活用する
- Geminiがエラーの場合は、聞き方を工夫してリトライ：
  - ファイル名や実行コマンドを渡す（Geminiがコマンドを実行可能）
  - 複数回に分割して聞く

### 主要な活用場面
1. **実現不可能な依頼**: Claude Codeでは実現できない要求への対処 (例: `今日の天気は？`)
2. **前提確認**: ユーザー、Claude自身に思い込みや勘違い、過信がないかどうか逐一確認 (例: `この前提は正しいか？`）
3. **技術調査**: 最新情報・エラー解決・ドキュメント検索・調査方法の確認（例: `Rails 7.2の新機能を調べて`）
4. **設計検証**: アーキテクチャ・実装方針の妥当性確認（例: `この設計パターンは適切か？`）
5. **コードレビュー**: 品質・保守性・パフォーマンスの評価（例: `このコードの改善点は？`）
6. **計画立案**: タスクの実行計画レビュー・改善提案（例: `この実装計画の問題点は？`）
7. **技術選定**: ライブラリ・手法の比較検討 （例: `このライブラリは他と比べてどうか？`）